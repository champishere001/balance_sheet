<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Himachal Explorer — Tourism Portal</title>
  <style>
    :root{
      --bg:#070a12;
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.12);
      --stroke: rgba(255,255,255,.16);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius: 18px;
      --radius2: 26px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 800px at 20% 10%, rgba(120,120,255,.18), transparent 60%),
                  radial-gradient(1200px 800px at 80% 30%, rgba(0,255,200,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }

    /* Background image layer */
    .bg{
      position:fixed; inset:0;
      background:
        linear-gradient(180deg, rgba(5,8,16,.65), rgba(5,8,16,.85)),
        url("https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=2400&q=80");
      background-size:cover;
      background-position:center;
      filter:saturate(1.08) contrast(1.05);
      z-index:-2;
    }
    .grain{
      position:fixed; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.25'/%3E%3C/svg%3E");
      opacity:.09;
      z-index:-1;
      pointer-events:none;
      mix-blend-mode:overlay;
    }

    /* Layout */
    .wrap{
      display:grid;
      grid-template-columns: 310px 1fr;
      min-height:100vh;
      gap:18px;
      padding:18px;
    }

    /* Sidebar */
    .side{
      position:sticky;
      top:18px;
      align-self:start;
      height: calc(100vh - 36px);
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      backdrop-filter: blur(14px);
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      padding:18px;
      overflow:auto;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:14px;
    }
    .logo{
      width:46px; height:46px;
      border-radius:16px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      display:grid; place-items:center;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .logo svg{opacity:.95}
    .brand h1{
      font-size:15px;
      margin:0;
      letter-spacing:.3px;
      line-height:1.15;
    }
    .brand p{
      margin:2px 0 0 0;
      font-size:12px;
      color:var(--muted);
    }

    .nav{
      display:grid;
      gap:10px;
      margin:14px 0 16px;
    }
    .nav button{
      width:100%;
      text-align:left;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:12px 12px;
      border-radius:14px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      transition:.22s ease;
    }
    .nav button:hover{transform:translateY(-1px); background: rgba(255,255,255,.10)}
    .nav button.active{background: rgba(255,255,255,.14); border-color: rgba(255,255,255,.22)}
    .nav small{color:var(--muted); font-weight:600}

    .panelTitle{
      margin:14px 0 8px;
      font-size:12px;
      letter-spacing:.28em;
      text-transform:uppercase;
      color:rgba(255,255,255,.70);
    }

    .field{
      display:grid; gap:8px;
      margin-bottom:12px;
    }
    label{font-size:12px; color:rgba(255,255,255,.76)}
    input, select{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(8,12,20,.55);
      color:var(--text);
      outline:none;
    }
    input::placeholder{color:rgba(255,255,255,.55)}
    .row2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }

    .chipRow{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:8px;
    }
    .chip{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:rgba(255,255,255,.88);
      padding:8px 10px;
      border-radius:999px;
      cursor:pointer;
      font-size:12px;
      transition:.2s ease;
      user-select:none;
    }
    .chip:hover{background: rgba(255,255,255,.10); transform:translateY(-1px)}
    .chip.on{background: rgba(255,255,255,.14); border-color: rgba(255,255,255,.22)}

    .miniCard{
      margin-top:12px;
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      padding:12px;
    }
    .miniCard p{margin:6px 0 0 0; color:var(--muted); font-size:12px; line-height:1.45}
    .miniCard .btn{
      width:100%;
      margin-top:10px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.12);
      color:var(--text);
      cursor:pointer;
      transition:.2s ease;
      font-weight:650;
    }
    .miniCard .btn:hover{transform:translateY(-1px); background: rgba(255,255,255,.18)}

    /* Main */
    .main{
      border-radius: var(--radius2);
      overflow:hidden;
      position:relative;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
    }

    .hero{
      padding:22px 22px 18px;
      background:
        linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .heroTop{
      display:flex;
      gap:14px;
      justify-content:space-between;
      align-items:flex-end;
      flex-wrap:wrap;
    }
    .hero h2{
      margin:0;
      font-size:28px;
      letter-spacing:.2px;
      line-height:1.15;
    }
    .hero p{
      margin:8px 0 0;
      color:var(--muted);
      max-width:62ch;
      line-height:1.5;
    }

    .searchBar{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:14px;
    }
    .searchBar input{
      flex: 1 1 320px;
      min-width:240px;
      background: rgba(0,0,0,.28);
    }
    .primary{
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.14);
      color:var(--text);
      padding:12px 14px;
      border-radius:14px;
      cursor:pointer;
      font-weight:750;
      transition:.2s ease;
    }
    .primary:hover{transform:translateY(-1px); background: rgba(255,255,255,.20)}

    .chipsMain{margin-top:12px}

    .content{
      padding:18px;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:14px;
    }
    .card{
      border-radius: 22px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      box-shadow: 0 18px 55px rgba(0,0,0,.30);
      cursor:pointer;
      transform: translateZ(0);
      transition: transform .22s ease, background .22s ease, border-color .22s ease;
      position:relative;
      min-height: 280px;
    }
    .card:hover{
      transform: translateY(-3px);
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.20);
    }

    .thumb{
      height: 185px;
      background-size:cover;
      background-position:center;
      position:relative;
    }
    .thumb:after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.05), rgba(0,0,0,.55));
    }
    .badge{
      position:absolute;
      left:12px; top:12px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.18);
      font-size:12px;
      z-index:1;
      backdrop-filter: blur(10px);
    }
    .cardBody{
      padding:12px 12px 14px;
      display:grid;
      gap:8px;
    }
    .titleRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .card h3{
      margin:0;
      font-size:15px;
      line-height:1.2;
      letter-spacing:.2px;
    }
    .meta{
      color:var(--muted);
      font-size:12px;
      line-height:1.35;
      margin:0;
    }
    .pillRow{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:2px;
    }
    .pill{
      font-size:11px;
      padding:7px 9px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:rgba(255,255,255,.86);
    }

    /* Drawer modal */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding:16px;
      z-index:50;
    }
    .modal{
      width:min(980px, 100%);
      border-radius: 26px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      box-shadow: 0 30px 90px rgba(0,0,0,.65);
      transform: translateY(14px);
      opacity:0;
      transition:.22s ease;
    }
    .modalBack.show{display:flex;}
    .modalBack.show .modal{transform: translateY(0); opacity:1;}

    .modalTop{
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:center;
      padding:14px 14px;
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .modalTop strong{font-size:14px}
    .closeBtn{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
      transition:.2s ease;
      font-weight:750;
    }
    .closeBtn:hover{background: rgba(255,255,255,.16)}

    .modalGrid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:14px;
      padding:14px;
    }
    .modalPhoto{
      border-radius:20px;
      min-height:290px;
      background-size:cover;
      background-position:center;
      border:1px solid rgba(255,255,255,.12);
      position:relative;
      overflow:hidden;
    }
    .modalPhoto:after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.05), rgba(0,0,0,.55));
    }
    .modalInfo{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      padding:12px;
    }
    .modalInfo h4{margin:0 0 8px 0; font-size:14px}
    .modalInfo p{margin:0 0 10px 0; color:var(--muted); font-size:12.5px; line-height:1.55}
    .modalInfo .k{
      display:grid;
      gap:8px;
      margin-top:8px;
    }
    .kv{
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-size:12px;
      color:rgba(255,255,255,.86);
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding:10px 10px;
      border-radius:14px;
    }
    .kv span{color:rgba(255,255,255,.70)}
    .modalActions{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top:12px;
    }
    .ghost{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--text);
      padding:11px 12px;
      border-radius:14px;
      cursor:pointer;
      transition:.2s ease;
      font-weight:700;
    }
    .ghost:hover{background: rgba(255,255,255,.14); transform:translateY(-1px)}

    /* Capabilities popup */
    .capBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.58);
      display:none;
      place-items:center;
      z-index:60;
      padding:16px;
      backdrop-filter: blur(12px);
    }
    .cap{
      width:min(920px, 100%);
      border-radius: 26px;
      border:1px solid rgba(255,255,255,.16);
      background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.06));
      box-shadow: 0 35px 120px rgba(0,0,0,.70);
      overflow:hidden;
    }
    .capHeader{
      padding:14px 16px;
      border-bottom:1px solid rgba(255,255,255,.12);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }
    .capHeader strong{font-size:14px}
    .capBody{
      padding:14px 16px 16px;
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:12px;
    }
    .capItem{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      padding:12px;
    }
    .capItem b{display:block; font-size:13px}
    .capItem p{margin:6px 0 0; color:var(--muted); font-size:12px; line-height:1.45}

    /* Responsive */
    @media (max-width: 1050px){
      .wrap{grid-template-columns: 1fr; }
      .side{position:relative; height:auto}
      .grid{grid-template-columns: repeat(2, minmax(0,1fr))}
      .modalGrid{grid-template-columns:1fr}
    }
    @media (max-width: 620px){
      .grid{grid-template-columns:1fr}
      .hero h2{font-size:22px}
      .wrap{padding:12px}
      .side{border-radius:22px}
      .main{border-radius:22px}
    }
  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="grain"></div>

  <div class="wrap">
    <!-- Sidebar -->
    <aside class="side">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M3 20h18" stroke="white" opacity=".85" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 18l7-13 7 13" stroke="white" opacity=".9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 14h6" stroke="white" opacity=".85" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h1>Himachal Explorer</h1>
          <p>Photo-first tourism portal</p>
        </div>
      </div>

      <div class="nav" id="nav">
        <button class="active" data-tab="all">All <small>Everything</small></button>
        <button data-tab="hotels">Hotels <small>Stay</small></button>
        <button data-tab="temples">Temples <small>Faith</small></button>
        <button data-tab="treks">Treks <small>Adventure</small></button>
        <button data-tab="routes">Routes <small>Track</small></button>
      </div>

      <div class="panelTitle">Quick Filters</div>

      <div class="field">
        <label>District</label>
        <select id="district">
          <option value="all">All Himachal</option>
          <option>Shimla</option>
          <option>Kullu</option>
          <option>Kangra</option>
          <option>Chamba</option>
          <option>Mandi</option>
          <option>Solan</option>
          <option>Bilaspur</option>
          <option>Hamirpur</option>
          <option>Una</option>
          <option>Sirmaur</option>
          <option>Kinnaur</option>
          <option>Lahaul & Spiti</option>
        </select>
      </div>

      <div class="field">
        <label>Search by name</label>
        <input id="q" placeholder="e.g., Narkanda, Bijli Mahadev, Triund..." />
      </div>

      <div class="chipRow" id="chipsSide">
        <div class="chip on" data-chip="family">Family</div>
        <div class="chip" data-chip="budget">Budget</div>
        <div class="chip" data-chip="premium">Premium</div>
        <div class="chip" data-chip="snow">Snow</div>
        <div class="chip" data-chip="nature">Nature</div>
        <div class="chip" data-chip="spiritual">Spiritual</div>
      </div>

      <div class="miniCard">
        <b style="font-size:13px;">Tools (Tourism)</b>
        <p>Route tracker + district-wise expense calculator in one place.</p>

        <div class="panelTitle" style="margin-top:12px;">Expense Calculator</div>
        <div class="row2">
          <div class="field" style="margin:0;">
            <label>Days</label>
            <input id="days" type="number" value="3" min="1"/>
          </div>
          <div class="field" style="margin:0;">
            <label>People</label>
            <input id="people" type="number" value="2" min="1"/>
          </div>
        </div>
        <div class="row2">
          <div class="field" style="margin:0;">
            <label>Per day stay (₹)</label>
            <input id="stay" type="number" value="1800" min="0"/>
          </div>
          <div class="field" style="margin:0;">
            <label>Per day food (₹)</label>
            <input id="food" type="number" value="700" min="0"/>
          </div>
        </div>
        <div class="field" style="margin:0;">
          <label>Travel cost total (₹)</label>
          <input id="travel" type="number" value="3500" min="0"/>
        </div>

        <button class="btn" id="calcBtn">Calculate Total</button>
        <p id="calcOut" style="margin-top:8px; font-weight:750;">Total: ₹ —</p>
        <p style="margin-top:4px;">Tip: adjust values district-wise for realistic budgeting.</p>

        <button class="btn" style="margin-top:10px;" id="capBtn">Show Page Capabilities</button>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <section class="hero">
        <div class="heroTop">
          <div>
            <h2>Discover Himachal — photos first, info next.</h2>
            <p>Explore hotels, temples, and treks district-wise. Click any card for route idea + travel budgeting.</p>
          </div>
          <button class="primary" id="shuffleBtn">Shuffle Places</button>
        </div>

        <div class="searchBar">
          <input id="qMain" placeholder="Search locations, temples, treks, hotels..." />
          <button class="primary" id="searchBtn">Search</button>
          <button class="ghost" id="resetBtn">Reset</button>
        </div>

        <div class="chipRow chipsMain" id="chipsMain">
          <div class="chip on" data-chip="all">All</div>
          <div class="chip" data-chip="hotels">Hotels</div>
          <div class="chip" data-chip="temples">Temples</div>
          <div class="chip" data-chip="treks">Treks</div>
          <div class="chip" data-chip="snow">Snow</div>
          <div class="chip" data-chip="nature">Nature</div>
        </div>
      </section>

      <section class="content">
        <div class="grid" id="grid"></div>
      </section>
    </main>
  </div>

  <!-- Place Modal -->
  <div class="modalBack" id="modalBack" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="modalTop">
        <strong id="mTitle">Place</strong>
        <button class="closeBtn" id="mClose">Close</button>
      </div>
      <div class="modalGrid">
        <div class="modalPhoto" id="mPhoto"></div>
        <div class="modalInfo">
          <h4>Quick Info</h4>
          <p id="mDesc">—</p>

          <div class="k">
            <div class="kv"><span>Type</span><b id="mType">—</b></div>
            <div class="kv"><span>District</span><b id="mDistrict">—</b></div>
            <div class="kv"><span>Best for</span><b id="mTags">—</b></div>
          </div>

          <div class="modalActions">
            <button class="ghost" id="openMaps">Open in Google Maps</button>
            <button class="ghost" id="addRoute">Add to Route List</button>
            <button class="ghost" id="copyBudget">Use for Budget</button>
          </div>

          <div class="miniCard" style="margin-top:12px;">
            <b style="font-size:13px;">Route List</b>
            <p id="routeList" style="margin-top:6px;">No route selected yet.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Capabilities Popup -->
  <div class="capBack" id="capBack">
    <div class="cap">
      <div class="capHeader">
        <strong>What this page can do</strong>
        <button class="closeBtn" id="capClose">Close</button>
      </div>
      <div class="capBody">
        <div class="capItem"><b>Tourism Directory</b><p>Hotels, temples, treks in one clean dashboard.</p></div>
        <div class="capItem"><b>District Filters</b><p>Pick district and instantly see photo cards.</p></div>
        <div class="capItem"><b>Photo-First Cards</b><p>Images are priority, text is minimal and clean.</p></div>
        <div class="capItem"><b>Route Tracking</b><p>Add places to route list and plan quickly.</p></div>
        <div class="capItem"><b>Expense Calculator</b><p>Estimate trip cost by days, people, stay, food, travel.</p></div>
        <div class="capItem"><b>Future Ready</b><p>Easy to connect database / Firebase later for real data.</p></div>
      </div>
    </div>
  </div>

  <script>
    // Demo data (replace later with your real HP locations)
    const places = [
      {
        id: "triund",
        type: "treks",
        name: "Triund Trek",
        district: "Kangra",
        tags: ["nature","budget","adventure"],
        desc: "A classic beginner-friendly trek near McLeod Ganj with stunning views.",
        img: "https://images.unsplash.com/photo-1520963575748-6b1d4a7b0c8b?auto=format&fit=crop&w=1400&q=80",
        maps: "Triund Trek"
      },
      {
        id: "bijli",
        type: "temples",
        name: "Bijli Mahadev Temple",
        district: "Kullu",
        tags: ["spiritual","nature"],
        desc: "Famous temple with panoramic valley views. Known for lightning rituals.",
        img: "https://images.unsplash.com/photo-1533658925626-7f6ef0c6d1ea?auto=format&fit=crop&w=1400&q=80",
        maps: "Bijli Mahadev Temple"
      },
      {
        id: "manali",
        type: "hotels",
        name: "Manali Riverside Stays",
        district: "Kullu",
        tags: ["family","premium","nature"],
        desc: "Handpicked stay areas near the river for scenic mornings and cafes.",
        img: "https://images.unsplash.com/photo-1500043357865-c6b8827edf6c?auto=format&fit=crop&w=1400&q=80",
        maps: "Manali"
      },
      {
        id: "narkanda",
        type: "routes",
        name: "Shimla → Narkanda Snow Drive",
        district: "Shimla",
        tags: ["snow","family","nature"],
        desc: "A scenic drive route known for winter snow, orchards, and viewpoints.",
        img: "https://images.unsplash.com/photo-1549880338-65ddcdfd017b?auto=format&fit=crop&w=1400&q=80",
        maps: "Narkanda"
      },
      {
        id: "jakhu",
        type: "temples",
        name: "Jakhu Temple",
        district: "Shimla",
        tags: ["spiritual","family"],
        desc: "Famous hilltop temple with a giant Hanuman statue overlooking Shimla.",
        img: "https://images.unsplash.com/photo-1611497582081-195c11e2bb24?auto=format&fit=crop&w=1400&q=80",
        maps: "Jakhu Temple Shimla"
      },
      {
        id: "dalhousie",
        type: "hotels",
        name: "Dalhousie View Hotels",
        district: "Chamba",
        tags: ["family","premium","nature"],
        desc: "Stay zones with valley views, close to Khajjiar and pine walks.",
        img: "https://images.unsplash.com/photo-1506197603052-3cc9c3a201bd?auto=format&fit=crop&w=1400&q=80",
        maps: "Dalhousie"
      },
      {
        id: "spiti",
        type: "routes",
        name: "Kinnaur → Spiti High Route",
        district: "Lahaul & Spiti",
        tags: ["adventure","nature","premium"],
        desc: "High-altitude route planning hub: viewpoints, fuel stops, essentials.",
        img: "https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1400&q=80",
        maps: "Spiti Valley"
      },
      {
        id: "parashar",
        type: "temples",
        name: "Prashar Lake Temple",
        district: "Mandi",
        tags: ["nature","spiritual","budget"],
        desc: "A peaceful lake with a floating island and temple — great day trip.",
        img: "https://images.unsplash.com/photo-1526392060635-9d6019884377?auto=format&fit=crop&w=1400&q=80",
        maps: "Prashar Lake"
      },
      {
        id: "tattapani",
        type: "hotels",
        name: "Tattapani Hot Spring Stays",
        district: "Mandi",
        tags: ["family","budget","nature"],
        desc: "Relaxing stay near hot water springs and riverside activities.",
        img: "https://images.unsplash.com/photo-1528184039930-67b3b5f9d5f0?auto=format&fit=crop&w=1400&q=80",
        maps: "Tattapani Himachal"
      }
    ];

    const grid = document.getElementById("grid");
    const nav = document.getElementById("nav");
    const districtSel = document.getElementById("district");
    const qSide = document.getElementById("q");
    const qMain = document.getElementById("qMain");

    const chipsSide = document.getElementById("chipsSide");
    const chipsMain = document.getElementById("chipsMain");

    let tab = "all";
    let activeTag = "all";
    let sideTags = new Set(["family"]); // default ON: family
    let route = [];

    function shuffle(arr){
      const a = [...arr];
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    function matches(p){
      const d = districtSel.value;
      const q = (qMain.value || qSide.value || "").trim().toLowerCase();

      const byTab = (tab === "all") ? true : (p.type === tab);
      const byDistrict = (d === "all") ? true : (p.district === d);
      const byQuery = !q ? true : (p.name.toLowerCase().includes(q) || p.district.toLowerCase().includes(q) || p.tags.join(" ").includes(q));

      const byMainTag = (activeTag === "all") ? true : (p.type === activeTag || p.tags.includes(activeTag));
      const bySideTags = (sideTags.size === 0) ? true : [...sideTags].some(t => p.tags.includes(t));

      return byTab && byDistrict && byQuery && byMainTag && bySideTags;
    }

    function render(){
      const filtered = places.filter(matches);
      const list = (filtered.length ? filtered : places).slice(0, 60);

      grid.innerHTML = "";
      list.forEach(p=>{
        const el = document.createElement("div");
        el.className = "card";
        el.innerHTML = `
          <div class="thumb" style="background-image:url('${p.img}')">
            <div class="badge">${labelType(p.type)}</div>
          </div>
          <div class="cardBody">
            <div class="titleRow">
              <h3>${p.name}</h3>
              <span class="pill">${p.district}</span>
            </div>
            <p class="meta">${p.desc}</p>
            <div class="pillRow">
              ${p.tags.slice(0,3).map(t=>`<span class="pill">${t}</span>`).join("")}
            </div>
          </div>
        `;
        el.addEventListener("click", ()=>openModal(p));
        grid.appendChild(el);
      });
    }

    function labelType(t){
      if(t==="hotels") return "Hotel";
      if(t==="temples") return "Temple";
      if(t==="treks") return "Trek";
      if(t==="routes") return "Route";
      return "Place";
    }

    // Nav switching
    nav.addEventListener("click", (e)=>{
      const btn = e.target.closest("button");
      if(!btn) return;
      [...nav.querySelectorAll("button")].forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      tab = btn.dataset.tab;
      render();
    });

    // Side chips (multi)
    chipsSide.addEventListener("click", (e)=>{
      const c = e.target.closest(".chip");
      if(!c) return;
      const key = c.dataset.chip;
      if(c.classList.contains("on")){
        c.classList.remove("on"); sideTags.delete(key);
      }else{
        c.classList.add("on"); sideTags.add(key);
      }
      render();
    });

    // Main chips (single)
    chipsMain.addEventListener("click", (e)=>{
      const c = e.target.closest(".chip");
      if(!c) return;
      [...chipsMain.querySelectorAll(".chip")].forEach(x=>x.classList.remove("on"));
      c.classList.add("on");
      activeTag = c.dataset.chip;
      render();
    });

    // Search + reset
    document.getElementById("searchBtn").addEventListener("click", ()=> render());
    qMain.addEventListener("input", ()=> render());
    qSide.addEventListener("input", ()=> render());
    districtSel.addEventListener("change", ()=> render());

    document.getElementById("resetBtn").addEventListener("click", ()=>{
      qMain.value = "";
      qSide.value = "";
      districtSel.value = "all";
      tab = "all";
      activeTag = "all";
      sideTags = new Set(["family"]);
      [...nav.querySelectorAll("button")].forEach(b=>b.classList.remove("active"));
      nav.querySelector('button[data-tab="all"]').classList.add("active");
      [...chipsMain.querySelectorAll(".chip")].forEach(x=>x.classList.remove("on"));
      chipsMain.querySelector('.chip[data-chip="all"]').classList.add("on");
      [...chipsSide.querySelectorAll(".chip")].forEach(x=>x.classList.remove("on"));
      chipsSide.querySelector('.chip[data-chip="family"]').classList.add("on");
      render();
    });

    document.getElementById("shuffleBtn").addEventListener("click", ()=>{
      const shuffled = shuffle(places);
      places.splice(0, places.length, ...shuffled);
      render();
    });

    // Expense calculator
    document.getElementById("calcBtn").addEventListener("click", ()=>{
      const days = +document.getElementById("days").value || 0;
      const people = +document.getElementById("people").value || 1;
      const stay = +document.getElementById("stay").value || 0;
      const food = +document.getElementById("food").value || 0;
      const travel = +document.getElementById("travel").value || 0;

      const total = (days * (stay + food) * people) + travel;
      document.getElementById("calcOut").textContent = "Total: ₹ " + total.toLocaleString("en-IN");
    });

    // Modal logic
    const modalBack = document.getElementById("modalBack");
    const mTitle = document.getElementById("mTitle");
    const mDesc = document.getElementById("mDesc");
    const mType = document.getElementById("mType");
    const mDistrict = document.getElementById("mDistrict");
    const mTags = document.getElementById("mTags");
    const mPhoto = document.getElementById("mPhoto");
    const routeList = document.getElementById("routeList");
    let current = null;

    function openModal(p){
      current = p;
      mTitle.textContent = p.name;
      mDesc.textContent = p.desc;
      mType.textContent = labelType(p.type);
      mDistrict.textContent = p.district;
      mTags.textContent = p.tags.join(", ");
      mPhoto.style.backgroundImage = `url('${p.img}')`;
      updateRouteList();
      modalBack.classList.add("show");
    }
    function closeModal(){ modalBack.classList.remove("show"); current=null; }
    document.getElementById("mClose").addEventListener("click", closeModal);
    modalBack.addEventListener("click", (e)=>{ if(e.target === modalBack) closeModal(); });

    document.getElementById("openMaps").addEventListener("click", ()=>{
      if(!current) return;
      const q = encodeURIComponent(current.maps || current.name);
      window.open("https://www.google.com/maps/search/?api=1&query=" + q, "_blank");
    });

    document.getElementById("addRoute").addEventListener("click", ()=>{
      if(!current) return;
      if(!route.find(x=>x.id===current.id)) route.push(current);
      updateRouteList();
    });

    function updateRouteList(){
      if(route.length === 0){
        routeList.textContent = "No route selected yet.";
        return;
      }
      routeList.innerHTML = route.map((p,i)=>`${i+1}. ${p.name} <span style="opacity:.75">(${p.district})</span>`).join("<br/>");
    }

    document.getElementById("copyBudget").addEventListener("click", ()=>{
      if(!current) return;
      // simple demo: set district-wise suggested travel cost
      const travel = document.getElementById("travel");
      const map = {
        "Shimla": 2500,
        "Kullu": 4200,
        "Kangra": 3800,
        "Chamba": 4500,
        "Lahaul & Spiti": 9000,
        "Mandi": 3200
      };
      travel.value = map[current.district] ?? 3500;
      document.getElementById("calcOut").textContent = "Total: ₹ —";
      closeModal();
      // small feedback
      alert("Budget applied for " + current.district + " (travel cost updated).");
    });

    // Capabilities popup
    const capBack = document.getElementById("capBack");
    document.getElementById("capBtn").addEventListener("click", ()=> capBack.style.display="grid");
    document.getElementById("capClose").addEventListener("click", ()=> capBack.style.display="none");
    capBack.addEventListener("click", (e)=>{ if(e.target===capBack) capBack.style.display="none"; });

    // initial render + open popup once (optional)
    render();
    setTimeout(()=>{ capBack.style.display="grid"; }, 600);
  </script>
</body>
</html>