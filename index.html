<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<title>Himachal Tour Packages | Himachal Explorer</title>
<meta name="description" content="Himachal tour packages with live map, day-wise itinerary, and place details popup."/>
<meta name="robots" content="index,follow"/>
<link rel="canonical" href="https://champishere001.github.io/"/>

<!-- Firebase compat -->
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-analytics-compat.js"></script>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body{
margin:0;
font-family:system-ui,Arial;
background:#070A12;
color:#fff;
}
header{
padding:14px;
border-bottom:1px solid rgba(255,255,255,.1);
display:flex;
justify-content:space-between;
align-items:center;
}
h1{margin:0;font-size:18px;letter-spacing:.1em}
.main{
display:grid;
grid-template-columns:320px 1fr 380px;
gap:12px;
padding:12px;
height:calc(100vh - 60px);
}
.pane{
border:1px solid rgba(255,255,255,.12);
border-radius:14px;
background:rgba(255,255,255,.04);
display:flex;
flex-direction:column;
overflow:hidden;
}
.paneHdr{
padding:10px;
border-bottom:1px solid rgba(255,255,255,.1);
font-size:12px;
letter-spacing:.2em;
text-transform:uppercase;
}
.pkgList,.daysList{
padding:10px;
overflow:auto;
}
.pkg{
padding:10px;
border:1px solid rgba(255,255,255,.1);
border-radius:12px;
margin-bottom:8px;
cursor:pointer;
background:rgba(255,255,255,.03);
}
.pkg:hover{background:rgba(255,255,255,.07)}
.day{
padding:10px;
border:1px solid rgba(255,255,255,.1);
border-radius:12px;
margin-bottom:10px;
}
.place{
padding:7px 9px;
border:1px solid rgba(255,255,255,.1);
border-radius:10px;
margin-top:6px;
cursor:pointer;
background:rgba(255,255,255,.04);
}
.place:hover{background:rgba(255,255,255,.08)}

#map{height:100%}

.modal{
position:fixed;
inset:0;
display:none;
align-items:center;
justify-content:center;
background:rgba(0,0,0,.6);
}
.modal.show{display:flex}
.card{
background:#0B1220;
padding:18px;
border-radius:16px;
width:min(560px,90%);
max-height:80vh;
overflow:auto;
}
button{
background:#7C3AED;
border:none;
padding:8px 12px;
border-radius:8px;
color:#fff;
cursor:pointer;
}
</style>
</head>

<body>

<header>
<h1>Himachal Explorer</h1>
<div>Live packages • Map • Itinerary</div>
</header>

<div class="main">

<!-- PACKAGES -->
<section class="pane">
<div class="paneHdr">Packages</div>
<div class="pkgList" id="pkgList"></div>
</section>

<!-- MAP -->
<section class="pane">
<div class="paneHdr">Map</div>
<div id="map"></div>
</section>

<!-- ITINERARY -->
<section class="pane">
<div class="paneHdr">Itinerary</div>
<div class="daysList" id="daysList"></div>
</section>

</div>

<!-- PLACE MODAL -->
<div class="modal" id="modal">
<div class="card">
<h2 id="mTitle"></h2>
<p id="mHistory"></p>
<ul id="mList"></ul>
<br>
<button onclick="closeModal()">Close</button>
</div>
</div>

<script>

/* ================= FIREBASE ================= */
const firebaseConfig = {
apiKey:"AIzaSyAKaFrj7JobWLloNQqzvx3SSibyrsiwzug",
authDomain:"revnue-records.firebaseapp.com",
databaseURL:"https://revnue-records-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId:"revnue-records",
storageBucket:"revnue-records.firebasestorage.app",
messagingSenderId:"182348503564",
appId:"1:182348503564:web:480085405b09177245ac29",
measurementId:"G-MGTDBCG896"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

/* ================= MAP ================= */
const map=L.map('map').setView([31.8,77.3],7);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
let markers=[];

/* ================= LOAD DATA ================= */
let places={},packages=[];

async function load(){
const p1=await db.ref("places").once("value");
places=p1.val()||{};
const p2=await db.ref("packages").once("value");
packages=Object.values(p2.val()||{});
renderPackages();
}
load();

/* ================= PACKAGES ================= */
function renderPackages(){
const box=document.getElementById("pkgList");
box.innerHTML="";
packages.forEach(pkg=>{
const div=document.createElement("div");
div.className="pkg";
div.textContent=pkg.name||"Package";
div.onclick=()=>selectPackage(pkg);
box.appendChild(div);
});
}

/* ================= SELECT PACKAGE ================= */
function selectPackage(pkg){

renderMap(pkg);
renderItinerary(pkg);

}

/* ================= MAP PINS ================= */
function renderMap(pkg){
markers.forEach(m=>map.removeLayer(m));
markers=[];
const ids=(pkg.itinerary||[]).flatMap(d=>d.places||[]);
ids.forEach(id=>{
const p=places[id];
if(!p) return;
const lat=p.latitude,lon=p.longitude;
if(!lat||!lon) return;
const m=L.marker([lat,lon]).addTo(map);
markers.push(m);
});
if(markers.length){
const group=L.featureGroup(markers);
map.fitBounds(group.getBounds().pad(.3));
}
}

/* ================= ITINERARY ================= */
function renderItinerary(pkg){
const box=document.getElementById("daysList");
box.innerHTML="";
(pkg.itinerary||[]).forEach((d,i)=>{
const day=document.createElement("div");
day.className="day";
day.innerHTML=`<b>Day ${i+1}</b>`;
(d.places||[]).forEach(id=>{
const p=places[id];
const line=document.createElement("div");
line.className="place";
line.textContent=p?.name||id;
line.onclick=()=>showPlace(p||{name:id});
day.appendChild(line);
});
box.appendChild(day);
});
}

/* ================= MODAL ================= */
function showPlace(p){
document.getElementById("mTitle").textContent=p.name||"Place";
document.getElementById("mHistory").textContent=p.history||"";
const ul=document.getElementById("mList");
ul.innerHTML="";
(p.what_you_find||"").split(/,|\n/).forEach(x=>{
if(!x.trim()) return;
const li=document.createElement("li");
li.textContent=x.trim();
ul.appendChild(li);
});
document.getElementById("modal").classList.add("show");
}
function closeModal(){
document.getElementById("modal").classList.remove("show");
}

</script>
</body>
</html>